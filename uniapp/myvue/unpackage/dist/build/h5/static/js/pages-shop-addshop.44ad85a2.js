(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-shop-addshop"],{"5be5":function(i,e,t){"use strict";var n=function(){var i=this,e=i.$createElement,t=i._self._c||e;return t("v-uni-view",[t("v-uni-view",{staticClass:"cu-form-group "},[t("v-uni-view",{staticClass:"title"},[i._v("商品名称")]),t("v-uni-input",{attrs:{placeholder:"商品名(不超过5个字符)",name:"input",maxlength:"5"},on:{input:function(e){e=i.$handleEvent(e),i.getname(e)}}})],1),t("v-uni-view",{staticClass:"cu-form-group margin-top"},[t("v-uni-view",{staticClass:"title"},[i._v("商品种类")]),t("v-uni-picker",{attrs:{value:i.typesindex,range:i.types},on:{change:function(e){e=i.$handleEvent(e),i.PickerChange(e)}}},[t("v-uni-view",{staticClass:"picker"},[i._v(i._s(i.typesindex>-1?i.types[i.typesindex]:"点击选择商品类别"))])],1)],1),t("v-uni-view",{staticClass:"cu-form-group margin-top"},[t("v-uni-view",{staticClass:"title"},[i._v("商品价格")]),t("v-uni-picker",{attrs:{value:i.priceindex,range:i.prices},on:{change:function(e){e=i.$handleEvent(e),i.PickerChange1(e)}}},[t("v-uni-view",{staticClass:"picker"},[i._v(i._s(i.priceindex>-1?i.prices[i.priceindex]+"球球币":"商品价格"))])],1)],1),t("v-uni-view",{staticClass:"cu-form-group "},[t("v-uni-view",{staticClass:"title"},[i._v("商品数量")]),t("v-uni-input",{attrs:{name:"input",maxlength:"3",type:"number",disabled:"true"},on:{input:function(e){e=i.$handleEvent(e),i.getnumbers(e)}},model:{value:i.numbers,callback:function(e){i.numbers=e},expression:"numbers"}})],1),t("v-uni-view",{staticClass:"cu-bar bg-white margin-top"},[t("v-uni-view",{staticClass:"action"},[i._v("商品图片(jpg/jpeg)")]),t("v-uni-view",{staticClass:"action"},[i._v(i._s(i.imgList.length)+"/1")])],1),t("v-uni-view",{staticClass:"cu-form-group"},[t("v-uni-view",{staticClass:"grid col-4 grid-square flex-sub"},[i._l(i.imgList,function(e,n){return t("v-uni-view",{key:n,staticClass:"bg-img",attrs:{"data-url":i.imgList[n]},on:{click:function(e){e=i.$handleEvent(e),i.ViewImage(e)}}},[t("v-uni-image",{attrs:{src:i.imgList[n],mode:"aspectFill"}}),t("v-uni-view",{staticClass:"cu-tag bg-red",attrs:{"data-index":n},on:{click:function(e){e.stopPropagation(),e=i.$handleEvent(e),i.DelImg(e)}}},[t("v-uni-text",{staticClass:"cuIcon-close"})],1)],1)}),i.imgList.length<1?t("v-uni-view",{staticClass:"solids",on:{click:function(e){e=i.$handleEvent(e),i.ChooseImage(e)}}},[t("v-uni-text",{staticClass:"cuIcon-cameraadd"})],1):i._e()],2)],1),t("v-uni-view",{staticClass:"padding-xl"},[t("v-uni-button",{staticClass:"cu-btn block bg-red margin-tb-sm lg",on:{click:function(e){e=i.$handleEvent(e),i.ok(e)}}},[t("v-uni-text",{directives:[{name:"show",rawName:"v-show",value:i.uping,expression:"uping"}],staticClass:"cuIcon-loading2 cuIconfont-spin"}),i._v("确认上传")],1)],1)],1)},s=[];t.d(e,"a",function(){return n}),t.d(e,"b",function(){return s})},"5c9c":function(i,e,t){"use strict";t.r(e);var n=t("9775"),s=t.n(n);for(var a in n)"default"!==a&&function(i){t.d(e,i,function(){return n[i]})}(a);e["default"]=s.a},"6c29":function(i,e,t){"use strict";t.r(e);var n=t("5be5"),s=t("5c9c");for(var a in s)"default"!==a&&function(i){t.d(e,i,function(){return s[i]})}(a);var u=t("2877"),c=Object(u["a"])(s["default"],n["a"],n["b"],!1,null,"1bcf6223",null);e["default"]=c.exports},9775:function(i,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,t("7f7f");var n={data:function(){return{user:null,types:["零食","熬夜","非卖品"],typesindex:-1,imgList:[],name:null,numbers:999,uping:!1,image:null,price:null,prices:[1,2,3,5,10],priceindex:-1}},onLoad:function(){this.islogin()},methods:{islogin:function(){var i=this;uni.getStorage({key:"user",success:function(e){i.user=e.data,null==i.user&&uni.showModal({title:"提示",content:"当前未登录请登录后再试！",cancelText:"不了",confirmText:"去登陆",success:function(i){i.confirm?uni.navigateTo({url:"../login/login"}):i.cancel&&uni.switchTab({url:"../movies/movies"})}})}})},ok:function(){var i=this;-1!=i.typesindex&&0!=i.imgList.length&&i.price&&this.name?(i.uping=!0,uni.uploadFile({url:getApp().globalData.zuul+"movies/movie/uploadVideo",header:{key:i.user.username,value:i.user.sessionid},filePath:i.imgList[0],name:"multipartFile",success:function(e){i.uping=!1;var t=JSON.parse(e.data);t.status?(i.image=t.data,i.addmv()):uni.showModal({title:"提示",content:t.msg,success:function(i){i.confirm||i.cancel}})}})):uni.showModal({title:"提示",content:"信息不完整！请检查后再上传！",success:function(i){i.confirm||i.cancel}})},addmv:function(){uni.request({url:getApp().globalData.zuul+"shops/shop/addshop",method:"POST",header:{"Content-Type":"application/x-www-form-urlencoded",key:this.user.username,value:this.user.sessionid},data:this.$qs.stringify({name:this.name,image:this.image,type:this.types[this.typesindex],number:this.numbers,price:this.price}),success:function(i){i.data.status?(uni.showToast({title:"保存成功！",duration:3e3,icon:"none"}),uni.redirectTo({url:"addshop"})):uni.showModal({title:"提示",content:"保存失败了！",success:function(i){i.confirm||i.cancel}})},fail:function(i){uni.showToast({title:"服务器出错啦！",duration:2e3,icon:"none"})}})},getname:function(i){this.name=i.detail.value},PickerChange:function(i){this.typesindex=i.detail.value},PickerChange1:function(i){this.priceindex=i.detail.value,this.price=this.prices[this.priceindex]},ViewImage:function(i){uni.previewImage({urls:this.imgList,current:i.currentTarget.dataset.url})},DelImg:function(i){var e=this;uni.showModal({title:"提示",content:"确定要删除这个封面吗？",cancelText:"不",confirmText:"换张好看的",success:function(t){t.confirm&&e.imgList.splice(i.currentTarget.dataset.index,1)}})},ChooseImage:function(){var i=this;uni.chooseImage({count:1,sizeType:["original","compressed"],sourceType:["album"],success:function(e){0!=i.imgList.length?i.imgList=i.imgList.concat(e.tempFilePaths):i.imgList=e.tempFilePaths}})}}};e.default=n}}]);